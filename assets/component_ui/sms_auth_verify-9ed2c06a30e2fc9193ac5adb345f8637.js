(function(){this.SmsAuthVerifyUI=flight.component(function(){return this.countDown=0,this.attributes({phoneNumberInput:"#token_sms_token_phone_number",verifyCodeInput:"#token_sms_token_verify_code",sendCodeButton:"button[value=send_code]"}),this.verifyPhoneNumber=function(event){return this.select("phoneNumberInput").parent().removeClass("has-error"),""===this.select("phoneNumberInput").val()?(this.select("phoneNumberInput").parent().addClass("has-error"),event.preventDefault()):setTimeout(function(_this){return function(){return _this.countDownSendCodeButton()}}(this),0)},this.countDownSendCodeButton=function(){var altName,countDownTimer,origName;return origName=this.select("sendCodeButton").data("orig-name"),altName=this.select("sendCodeButton").data("alt-name"),this.countDown=30,this.select("sendCodeButton").attr("disabled","disabled").addClass("disabled"),(countDownTimer=function(_this){return function(){return setTimeout(function(){return 0!==_this.countDown?(_this.countDown--,_this.select("sendCodeButton").text(altName.replace("COUNT",_this.countDown)),countDownTimer()):_this.select("sendCodeButton").removeAttr("disabled").removeClass("disabled").text(origName)},1e3)}}(this))()},this.beforeSend=function(event,jqXHR,settings){var input;if(!settings.data.match("send_code"))return input=this.select("verifyCodeInput"),input.parent().removeClass("has-error"),""===input.val()?(input.parent().addClass("has-error"),jqXHR.abort()):void 0},this.handleSuccess=function(event,text){var data;return data=JSON.parse(text),data.reload&&window.location.reload(),this.trigger("flash:notice",{msg:data.text})},this.handleError=function(event,jqXHR){var data;return data=JSON.parse(jqXHR.responseText),this.countDown=0,this.trigger("flash:alert",{msg:data.text})},this.after("initialize",function(){return this.on(this.select("sendCodeButton"),"click",this.verifyPhoneNumber),this.on("ajax:beforeSend",this.beforeSend),this.on("ajax:success",this.handleSuccess),this.on("ajax:error",this.handleError)})})}).call(this);