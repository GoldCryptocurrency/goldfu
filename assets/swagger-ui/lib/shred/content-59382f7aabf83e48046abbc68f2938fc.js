var Content=function(options){this.body=options.body,this.data=options.data,this.type=options.type};Content.prototype={},Object.defineProperties(Content.prototype,{type:{get:function(){if(this._type)return this._type;if(this._data)switch(typeof this._data){case"string":return"text/plain";case"object":return"application/json"}return"text/plain"},set:function(value){return this._type=value,this},enumerable:!0},data:{get:function(){return this._body?this.processor.parser(this._body):this._data},set:function(data){return this._body&&data&&Errors.setDataWithBody(this),this._data=data,this},enumerable:!0},body:{get:function(){return this._data?this.processor.stringify(this._data):this._body.toString()},set:function(body){return this._data&&body&&Errors.setBodyWithData(this),this._body=body,this},enumerable:!0},processor:{get:function(){var processor=Content.processors[this.type];if(processor)return processor;for(var main=this.type.split(";")[0],parts=main.split(/\+|\//),i=0,l=parts.length;l>i;i++)processor=Content.processors[parts[i]];return processor||{parser:identity,stringify:toString}},enumerable:!0},length:{get:function(){return"undefined"!=typeof Buffer?Buffer.byteLength(this.body):this.body.length}}}),Content.processors={},Content.registerProcessor=function(types,processor){types.forEach?types.forEach(function(type){Content.processors[type]=processor}):Content.processors[types]=processor};var identity=function(x){return x},toString=function(x){return x.toString()};Content.registerProcessor(["text/html","text/plain","text"],{parser:identity,stringify:toString}),Content.registerProcessor(["application/json; charset=utf-8","application/json","json"],{parser:function(string){return JSON.parse(string)},stringify:function(data){return JSON.stringify(data)}});var qs=require("querystring");Content.registerProcessor(["application/x-www-form-urlencoded"],{parser:qs.parse,stringify:qs.stringify});var Errors={setDataWithBody:function(){throw new Error("Attempt to set data attribute of a content object when the body attributes was already set.")},setBodyWithData:function(){throw new Error("Attempt to set body attribute of a content object when the data attributes was already set.")}};module.exports=Content;