(function(){var $,Events,Log,Model,Module,PeatioModel,createObject,isArray,isBlank,makeArray,moduleKeywords,__slice=[].slice,__indexOf=[].indexOf||function(item){for(var i=0,l=this.length;l>i;i++)if(i in this&&this[i]===item)return i;return-1},__hasProp={}.hasOwnProperty,__extends=function(child,parent){function ctor(){this.constructor=child}for(var key in parent)__hasProp.call(parent,key)&&(child[key]=parent[key]);return ctor.prototype=parent.prototype,child.prototype=new ctor,child.__super__=parent.prototype,child};Events={bind:function(ev,callback){var evs,name,_base,_i,_len;for(evs=ev.split(" "),this.hasOwnProperty("_callbacks")&&this._callbacks||(this._callbacks={}),_i=0,_len=evs.length;_len>_i;_i++)name=evs[_i],(_base=this._callbacks)[name]||(_base[name]=[]),this._callbacks[name].push(callback);return this},one:function(ev,callback){var handler;return this.bind(ev,handler=function(){return this.unbind(ev,handler),callback.apply(this,arguments)})},trigger:function(){var args,callback,ev,list,_i,_len,_ref;if(args=1<=arguments.length?__slice.call(arguments,0):[],ev=args.shift(),list=this.hasOwnProperty("_callbacks")&&(null!=(_ref=this._callbacks)?_ref[ev]:void 0)){for(_i=0,_len=list.length;_len>_i&&(callback=list[_i],callback.apply(this,args)!==!1);_i++);return!0}},listenTo:function(obj,ev,callback){return obj.bind(ev,callback),this.listeningTo||(this.listeningTo=[]),this.listeningTo.push({obj:obj,ev:ev,callback:callback}),this},listenToOnce:function(obj,ev,callback){var handler,listeningToOnce;return listeningToOnce=this.listeningToOnce||(this.listeningToOnce=[]),obj.bind(ev,handler=function(){var i,idx,lt,_i,_len;for(idx=-1,i=_i=0,_len=listeningToOnce.length;_len>_i;i=++_i)lt=listeningToOnce[i],lt.obj===obj&&lt.ev===ev&&lt.callback===callback&&(idx=i);return obj.unbind(ev,handler),-1!==idx&&listeningToOnce.splice(idx,1),callback.apply(this,arguments)}),listeningToOnce.push({obj:obj,ev:ev,callback:callback,handler:handler}),this},stopListening:function(obj,events,callback){var e,ev,evts,idx,listeningTo,lt,_i,_j,_k,_len,_len1,_len2,_ref,_ref1,_results;if(0===arguments.length){for(_ref=[this.listeningTo,this.listeningToOnce],_i=0,_len=_ref.length;_len>_i;_i++)if(listeningTo=_ref[_i])for(_j=0,_len1=listeningTo.length;_len1>_j;_j++)lt=listeningTo[_j],lt.obj.unbind(lt.ev,lt.handler||lt.callback);return this.listeningTo=void 0,this.listeningToOnce=void 0}if(obj){for(_ref1=[this.listeningTo,this.listeningToOnce],_results=[],_k=0,_len2=_ref1.length;_len2>_k;_k++)listeningTo=_ref1[_k],listeningTo&&(events=events?events.split(" "):[void 0],_results.push(function(){var _l,_len3,_results1;for(_results1=[],_l=0,_len3=events.length;_len3>_l;_l++)ev=events[_l],_results1.push(function(){var _m,_ref2,_results2;for(_results2=[],idx=_m=_ref2=listeningTo.length-1;0>=_ref2?0>=_m:_m>=0;idx=0>=_ref2?++_m:--_m)lt=listeningTo[idx],callback&&(lt.handler||lt.callback)!==callback||(ev&&ev!==lt.ev?ev?(evts=lt.ev.split(" "),__indexOf.call(evts,ev)>=0?(evts=function(){var _len4,_n,_results3;for(_results3=[],_n=0,_len4=evts.length;_len4>_n;_n++)e=evts[_n],e!==ev&&_results3.push(e);return _results3}(),lt.ev=$.trim(evts.join(" ")),_results2.push(lt.obj.unbind(ev,lt.handler||lt.callback))):_results2.push(void 0)):_results2.push(void 0):(lt.obj.unbind(lt.ev,lt.handler||lt.callback),-1!==idx?_results2.push(listeningTo.splice(idx,1)):_results2.push(void 0)));return _results2}());return _results1}()));return _results}},unbind:function(ev,callback){var cb,evs,i,list,name,_i,_j,_len,_len1,_ref;if(0===arguments.length)return this._callbacks={},this;if(!ev)return this;for(evs=ev.split(" "),_i=0,_len=evs.length;_len>_i;_i++)if(name=evs[_i],list=null!=(_ref=this._callbacks)?_ref[name]:void 0)if(callback){for(i=_j=0,_len1=list.length;_len1>_j;i=++_j)if(cb=list[i],cb===callback){list=list.slice(),list.splice(i,1),this._callbacks[name]=list;break}}else delete this._callbacks[name];return this}},Events.on=Events.bind,Events.off=Events.unbind,Log={trace:!0,logPrefix:"(App)",log:function(){var args;return args=1<=arguments.length?__slice.call(arguments,0):[],this.trace?(this.logPrefix&&args.unshift(this.logPrefix),"undefined"!=typeof console&&null!==console&&"function"==typeof console.log&&console.log.apply(console,args),this):void 0}},moduleKeywords=["included","extended"],Module=function(){function Module(){"function"==typeof this.init&&this.init.apply(this,arguments)}return Module.include=function(obj){var key,value,_ref;if(!obj)throw new Error("include(obj) requires obj");for(key in obj)value=obj[key],__indexOf.call(moduleKeywords,key)<0&&(this.prototype[key]=value);return null!=(_ref=obj.included)&&_ref.apply(this),this},Module.extend=function(obj){var key,value,_ref;if(!obj)throw new Error("extend(obj) requires obj");for(key in obj)value=obj[key],__indexOf.call(moduleKeywords,key)<0&&(this[key]=value);return null!=(_ref=obj.extended)&&_ref.apply(this),this},Module.proxy=function(func){return function(_this){return function(){return func.apply(_this,arguments)}}(this)},Module.prototype.proxy=function(func){return function(_this){return function(){return func.apply(_this,arguments)}}(this)},Module}(),Model=function(_super){function Model(atts){Model.__super__.constructor.apply(this,arguments),null!=this.constructor.uuid&&"function"==typeof this.constructor.uuid?(this.cid=this.constructor.uuid(),this.id||(this.id=this.cid)):this.cid=(null!=atts?atts.cid:void 0)||this.constructor.uid("c-"),atts&&this.load(atts)}return __extends(Model,_super),Model.extend(Events),Model.records=[],Model.irecords={},Model.attributes=[],Model.configure=function(){var attributes,name;return name=arguments[0],attributes=2<=arguments.length?__slice.call(arguments,1):[],this.className=name,this.deleteAll(),attributes.length&&(this.attributes=attributes),this.attributes&&(this.attributes=makeArray(this.attributes)),this.attributes||(this.attributes=[]),this.unbind(),this},Model.toString=function(){return""+this.className+"("+this.attributes.join(", ")+")"},Model.find=function(id,notFound){var _ref;return null==notFound&&(notFound=this.notFound),(null!=(_ref=this.irecords[id])?_ref.clone():void 0)||("function"==typeof notFound?notFound(id):void 0)},Model.findAll=function(ids,notFound){var id,_i,_len,_results;for(_results=[],_i=0,_len=ids.length;_len>_i;_i++)id=ids[_i],this.find(id,notFound)&&_results.push(this.find(id));return _results},Model.notFound=function(){return null},Model.exists=function(id){return Boolean(this.irecords[id])},Model.addRecord=function(record,options){var _base,_base1,_name,_name1;return null==options&&(options={}),record.id&&this.irecords[record.id]&&(this.irecords[record.id].remove(options),options.clear||(record=this.irecords[record.id].load(record))),record.id||(record.id=record.cid),null==(_base=this.irecords)[_name=record.id]&&(_base[_name]=record),null==(_base1=this.irecords)[_name1=record.cid]&&(_base1[_name1]=record),this.records.push(record)},Model.refresh=function(values,options){var record,records,result,_i,_len;for(null==options&&(options={}),options.clear&&this.deleteAll(),records=this.fromJSON(values),isArray(records)||(records=[records]),_i=0,_len=records.length;_len>_i;_i++)record=records[_i],this.addRecord(record,options);return this.sort(),result=this.cloneArray(records),this.trigger("refresh",result,options),result},Model.select=function(callback){var record,_i,_len,_ref,_results;for(_ref=this.records,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)record=_ref[_i],callback(record)&&_results.push(record.clone());return _results},Model.findBy=function(name,value){var record,_i,_len,_ref;for(_ref=this.records,_i=0,_len=_ref.length;_len>_i;_i++)if(record=_ref[_i],record[name]===value)return record.clone();return null},Model.findAllBy=function(name,value){return this.select(function(item){return item[name]===value})},Model.each=function(callback){var record,_i,_len,_ref,_results;for(_ref=this.records,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)record=_ref[_i],_results.push(callback(record.clone()));return _results},Model.all=function(){return this.cloneArray(this.records)},Model.slice=function(begin,end){return null==begin&&(begin=0),this.cloneArray(this.records.slice(begin,end))},Model.first=function(end){var _ref;return null==end&&(end=1),end>1?this.cloneArray(this.records.slice(0,end)):null!=(_ref=this.records[0])?_ref.clone():void 0},Model.last=function(begin){var _ref;return"number"==typeof begin?this.cloneArray(this.records.slice(-begin)):null!=(_ref=this.records[this.records.length-1])?_ref.clone():void 0},Model.count=function(){return this.records.length},Model.deleteAll=function(){return this.records=[],this.irecords={}},Model.destroyAll=function(options){var record,_i,_len,_ref,_results;for(_ref=this.records,_results=[],_i=0,_len=_ref.length;_len>_i;_i++)record=_ref[_i],_results.push(record.destroy(options));return _results},Model.update=function(id,atts,options){return this.find(id).updateAttributes(atts,options)},Model.create=function(atts,options){var record;return record=new this(atts),record.save(options)},Model.destroy=function(id,options){return this.find(id).destroy(options)},Model.change=function(callbackOrParams){return"function"==typeof callbackOrParams?this.bind("change",callbackOrParams):this.trigger.apply(this,["change"].concat(__slice.call(arguments)))},Model.fetch=function(callbackOrParams){return"function"==typeof callbackOrParams?this.bind("fetch",callbackOrParams):this.trigger.apply(this,["fetch"].concat(__slice.call(arguments)))},Model.toJSON=function(){return this.records},Model.fromJSON=function(objects){var value,_i,_len,_results;if(objects){if("string"==typeof objects&&(objects=JSON.parse(objects)),isArray(objects)){for(_results=[],_i=0,_len=objects.length;_len>_i;_i++)value=objects[_i],value instanceof this?_results.push(value):_results.push(new this(value));return _results}return objects instanceof this?objects:new this(objects)}},Model.fromForm=function(){var _ref;return(_ref=new this).fromForm.apply(_ref,arguments)},Model.sort=function(){return this.comparator&&this.records.sort(this.comparator),this},Model.cloneArray=function(array){var value,_i,_len,_results;for(_results=[],_i=0,_len=array.length;_len>_i;_i++)value=array[_i],_results.push(value.clone());return _results},Model.idCounter=0,Model.uid=function(prefix){var uid;return null==prefix&&(prefix=""),uid=prefix+this.idCounter++,this.exists(uid)&&(uid=this.uid(prefix)),uid},Model.prototype.isNew=function(){return!this.exists()},Model.prototype.isValid=function(){return!this.validate()},Model.prototype.validate=function(){},Model.prototype.load=function(atts){var key,value;atts.id&&(this.id=atts.id);for(key in atts)if(value=atts[key],"function"==typeof this[key]){if("function"==typeof value)continue;this[key](value)}else this[key]=value;return this},Model.prototype.attributes=function(){var key,result,_i,_len,_ref;for(result={},_ref=this.constructor.attributes,_i=0,_len=_ref.length;_len>_i;_i++)key=_ref[_i],key in this&&(result[key]="function"==typeof this[key]?this[key]():this[key]);return this.id&&(result.id=this.id),result},Model.prototype.eql=function(rec){return rec&&rec.constructor===this.constructor&&(rec.cid===this.cid||rec.id&&rec.id===this.id)},Model.prototype.save=function(options){var error,record;return null==options&&(options={}),options.validate!==!1&&(error=this.validate())?(this.trigger("error",error),!1):(this.trigger("beforeSave",options),record=this.isNew()?this.create(options):this.update(options),this.stripCloneAttrs(),this.trigger("save",options),record)},Model.prototype.stripCloneAttrs=function(){var key,value;if(!this.hasOwnProperty("cid")){for(key in this)__hasProp.call(this,key)&&(value=this[key],__indexOf.call(this.constructor.attributes,key)>=0&&delete this[key]);return this}},Model.prototype.updateAttribute=function(name,value,options){var atts;return atts={},atts[name]=value,this.updateAttributes(atts,options)},Model.prototype.updateAttributes=function(atts,options){return this.load(atts),this.save(options)},Model.prototype.changeID=function(id){var records;if(id!==this.id)return records=this.constructor.irecords,records[id]=records[this.id],this.cid!==this.id&&delete records[this.id],this.id=id,this.save()},Model.prototype.remove=function(options){var i,record,records,_i,_len;for(null==options&&(options={}),records=this.constructor.records.slice(0),i=_i=0,_len=records.length;_len>_i;i=++_i)if(record=records[i],this.eql(record)){records.splice(i,1);break}return this.constructor.records=records,options.clear?(delete this.constructor.irecords[this.id],delete this.constructor.irecords[this.cid]):void 0},Model.prototype.destroy=function(options){return null==options&&(options={}),null==options.clear&&(options.clear=!0),this.trigger("beforeDestroy",options),this.remove(options),this.destroyed=!0,this.trigger("destroy",options),this.trigger("change","destroy",options),this.listeningTo&&this.stopListening(),this.unbind(),this},Model.prototype.dup=function(newRecord){var atts;return null==newRecord&&(newRecord=!0),atts=this.attributes(),newRecord?delete atts.id:atts.cid=this.cid,new this.constructor(atts)},Model.prototype.clone=function(){return createObject(this)},Model.prototype.reload=function(){var original;return this.isNew()?this:(original=this.constructor.find(this.id),this.load(original.attributes()),original)},Model.prototype.refresh=function(data){var root;return root=this.constructor.irecords[this.id],root.load(data),this.trigger("refresh"),this},Model.prototype.toJSON=function(){return this.attributes()},Model.prototype.toString=function(){return"<"+this.constructor.className+" ("+JSON.stringify(this)+")>"},Model.prototype.fromForm=function(form){var checkbox,key,name,result,_i,_j,_k,_len,_len1,_len2,_name,_ref,_ref1,_ref2;for(result={},_ref=$(form).find("[type=checkbox]:not([value])"),_i=0,_len=_ref.length;_len>_i;_i++)checkbox=_ref[_i],result[checkbox.name]=$(checkbox).prop("checked");for(_ref1=$(form).find('[type=checkbox][name$="[]"]'),_j=0,_len1=_ref1.length;_len1>_j;_j++)checkbox=_ref1[_j],name=checkbox.name.replace(/\[\]$/,""),result[name]||(result[name]=[]),$(checkbox).prop("checked")&&result[name].push(checkbox.value);for(_ref2=$(form).serializeArray(),_k=0,_len2=_ref2.length;_len2>_k;_k++)key=_ref2[_k],result[_name=key.name]||(result[_name]=key.value);return this.load(result)},Model.prototype.exists=function(){return this.constructor.exists(this.id)},Model.prototype.update=function(options){var clone,records;return this.trigger("beforeUpdate",options),records=this.constructor.irecords,records[this.id].load(this.attributes()),this.constructor.sort(),clone=records[this.id].clone(),clone.trigger("update",options),clone.trigger("change","update",options),clone},Model.prototype.create=function(options){var clone,record;return this.trigger("beforeCreate",options),this.id||(this.id=this.cid),record=this.dup(!1),this.constructor.addRecord(record),this.constructor.sort(),clone=record.clone(),clone.trigger("create",options),clone.trigger("change","create",options),clone},Model.prototype.bind=function(events,callback){var binder,singleEvent,_fn,_i,_len,_ref;for(this.constructor.bind(events,binder=function(_this){return function(record){return record&&_this.eql(record)?callback.apply(_this,arguments):void 0}}(this)),_ref=events.split(" "),_fn=function(_this){return function(singleEvent){var unbinder;return _this.constructor.bind("unbind",unbinder=function(record,event,cb){if(record&&_this.eql(record)){if(event&&event!==singleEvent)return;if(cb&&cb!==callback)return;return _this.constructor.unbind(singleEvent,binder),_this.constructor.unbind("unbind",unbinder)}})}}(this),_i=0,_len=_ref.length;_len>_i;_i++)singleEvent=_ref[_i],_fn(singleEvent);return this},Model.prototype.one=function(events,callback){var handler;return this.bind(events,handler=function(_this){return function(){return _this.unbind(events,handler),callback.apply(_this,arguments)}}(this))},Model.prototype.trigger=function(){var args,_ref;return args=1<=arguments.length?__slice.call(arguments,0):[],args.splice(1,0,this),(_ref=this.constructor).trigger.apply(_ref,args)},Model.prototype.listenTo=function(){return Events.listenTo.apply(this,arguments)},Model.prototype.listenToOnce=function(){return Events.listenToOnce.apply(this,arguments)},Model.prototype.stopListening=function(){return Events.stopListening.apply(this,arguments)},Model.prototype.unbind=function(events,callback){var event,_i,_len,_ref,_results;if(0===arguments.length)return this.trigger("unbind");if(events){for(_ref=events.split(" "),_results=[],_i=0,_len=_ref.length;_len>_i;_i++)event=_ref[_i],_results.push(this.trigger("unbind",event,callback));return _results}},Model}(Module),Model.prototype.on=Model.prototype.bind,Model.prototype.off=Model.prototype.unbind,$=("undefined"!=typeof window&&null!==window?window.jQuery:void 0)||("undefined"!=typeof window&&null!==window?window.Zepto:void 0)||function(element){return element},createObject=Object.create||function(o){var Func;return Func=function(){},Func.prototype=o,new Func},isArray=function(value){return"[object Array]"===Object.prototype.toString.call(value)},isBlank=function(value){var key;if(!value)return!0;for(key in value)return!1;return!0},makeArray=function(args){return Array.prototype.slice.call(args,0)},PeatioModel=this.PeatioModel={},"undefined"!=typeof module&&null!==module&&(module.exports=PeatioModel),PeatioModel.version="1.3.2.customizatiion",PeatioModel.isArray=isArray,PeatioModel.isBlank=isBlank,PeatioModel.$=$,PeatioModel.Events=Events,PeatioModel.Log=Log,PeatioModel.Module=Module,PeatioModel.Model=Model,Module.extend.call(PeatioModel,Events),Model.setup=function(name,attributes){var Instance;return null==attributes&&(attributes=[]),Instance=function(_super){function Instance(){return Instance.__super__.constructor.apply(this,arguments)}return __extends(Instance,_super),Instance}(this),Instance.configure.apply(Instance,[name].concat(__slice.call(attributes))),Instance},PeatioModel.Class=Module}).call(this);